library(tidyverse)
library(readxl)
library(factoextra)

master_data <- read_xlsx("../master_data.xlsx")
glimpse(master_data)

# Rows: 301
# Columns: 16
# $ playerID  <chr> "adonjo01", "bradiky01", "cabreed02", "cannigr01", "carraca01", "colege01", "desclan01", "detmere…
# $ yearID    <dbl> 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2…
# $ FF_vel    <dbl> 94.5, 94.5, 96.2, 94.7, 92.7, 96.7, 93.2, 94.4, 94.0, 96.0, 90.8, 90.6, 95.7, 89.5, 90.7, 92.3, 9…
# $ SL_vel    <dbl> 87.3, 88.1, 88.2, 88.4, 84.1, 89.1, 87.4, 88.9, 85.0, 89.9, 82.8, 84.8, 88.0, 79.2, 83.1, 80.8, 8…
# $ CH_vel    <dbl> 88.1, 90.8, 92.9, 90.2, 87.2, 89.1, 86.4, 84.8, 86.2, 88.5, 84.1, 81.6, 88.8, 86.5, 84.0, 83.2, 8…
# $ CU_vel    <dbl> 80.8, 84.8, 84.6, 81.8, 80.0, 82.9, 82.2, 74.7, 74.2, 83.6, 77.7, 77.6, 78.2, 72.4, 79.1, 75.9, 8…
# $ FF_ivb    <dbl> 13.6, 12.6, 16.1, 15.7, 12.1, 17.4, 15.5, 16.0, 13.1, 13.9, 15.0, 17.2, 13.0, 15.7, 14.7, 15.6, 1…
# $ SL_ivb    <dbl> 6.0, -0.1, 1.7, -3.4, 0.8, 1.7, 6.4, 2.9, 2.3, 6.7, -3.1, 4.8, 3.1, 2.4, 6.1, 3.7, 3.2, 3.2, 0.6,…
# $ CH_ivb    <dbl> 4.6, 7.6, 7.8, 4.4, 0.8, 10.1, 3.5, 8.0, 4.7, 4.9, 1.9, 10.4, 6.8, 4.2, 1.9, 2.5, 0.9, 7.2, 10.7,…
# $ CU_ivb    <dbl> -7.4, -12.8, -7.5, -7.3, -6.0, -13.7, -5.4, -14.8, -16.3, -2.4, -7.9, -11.1, -8.8, -10.8, -8.9, -…
# $ FF_ihb    <dbl> 9.3, 2.9, 9.1, 7.4, 5.5, 8.4, 10.8, 10.6, 0.7, 10.7, 7.5, 7.2, 10.0, 2.9, 6.1, 7.8, 7.4, 9.8, 6.8…
# $ SL_ihb    <dbl> 3.3, 12.5, 2.7, 0.1, 3.7, 4.7, 4.0, 1.3, 5.1, 3.2, 10.3, 4.7, 3.5, 13.6, 5.3, 9.7, 1.6, 2.5, 3.9,…
# $ CH_ihb    <dbl> 15.9, 12.5, 16.6, 16.3, 8.2, 14.2, 15.5, 12.7, 12.5, 18.4, 14.4, 9.5, 14.4, 13.3, 13.6, 10.4, 15.…
# $ CU_ihb    <dbl> 6.6, 5.5, 10.2, 12.0, 9.2, 10.1, 9.7, 11.4, 9.3, 12.2, 10.3, 7.6, 12.2, 11.5, 9.0, 9.2, 8.9, 6.1,…
# $ pointsWon <dbl> 0, 39, 0, 0, 0, 210, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
# $ Vote_Flag <dbl> 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…

pca_data <- master_data[,3:14]

pca <- prcomp(pca_data, scale. = TRUE, center = TRUE)
pca

summary(pca)

pca$rotation

biplot(pca)

plot(pca, type = "l")

screeplot(pca, type = "lines")

fviz_pca_var(pca, col.var = "contrib", 
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))

fviz_contrib(pca, choice = "var", axes = 1)  # PC1
fviz_contrib(pca, choice = "var", axes = 2)  # PC2

fviz_eig(pca, addlabels = TRUE)
