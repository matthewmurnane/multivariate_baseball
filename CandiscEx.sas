dm "output;clear;log;clear";
GOPTIONS reset=all goutmode=replace;
OPTIONS PAGENO=1;
OPTIONS LINESIZE=75 PAGESIZE=66 NODATE;

ODS RTF File="/home/sungkim0/STAT550/Candisc_ex.doc"; 
ODS Listing Close;
GOptions NoPrompt Vsize=6 Hsize=6 Horigin=1.2 Vorigin=2.5 FText=SwissX FTitle=SwissX HText=1 HTitle=1;

TITLE 'Ex. 7.2- SIZE MEASUREMENTS ON WHEAT KERNELS';
DATA Z1;
INPUT DOWN_A DOWN_P DOWN_L DOWN_B;
NN = _N_;
LOC = 'MAS0  ';
VARIETY = 'ARKAN ';
GRP=1;
CARDS;
2965 219 89 43
3041 221 91 46
2907 223 90 44
2728 212 87 41
2658 207 78 42
2543 203 82 41
2551 208 84 40
2784 218 91 41
2887 216 81 44
2752 219 93 40
2583 213 89 38
2697 209 82 43
2835 215 89 42
3005 225 95 42
2791 224 94 39
2599 211 86 40
3074 229 95 44
2785 212 84 44
3009 221 91 43
2603 205 83 41
2874 223 91 42
2706 211 91 42
2776 221 92 40
2566 204 81 43
2555 213 78 41
2679 214 88 41
2638 214 87 41
2779 232 89 71
2770 216 88 42
2930 218 84 45
2550 207 86 39
2692 212 82 43
2616 216 84 41
2799 216 88 41
2844 222 92 43
2985 224 91 43
;
DATA Z2;
INPUT RIGHT_A RIGHT_P RIGHT_L RIGHT_B;
NN = _N_;
LOC = 'MAS0  ';
VARIETY = 'ARKAN ';
GRP=1;
CARDS;
3204 226 89 47
3165 224 91 46
3035 223 91 44
2867 215 88 44
2807 211 81 44
2623 207 82 42
2784 211 84 42
2740 216 90 41
3228 221 86 50
3036 226 93 46
2775 220 90 41
2777 210 83 44
2893 218 89 44
3111 230 94 45
3063 232 89 44
2892 212 86 44
3030 227 94 43
2713 210 79 42
2954 230 94 42
2708 210 83 43
2911 220 91 42
2959 216 88 44
2838 221 92 40
2702 204 81 44
2645 210 85 42
2784 212 88 43
2606 209 87 40
2926 212 85 45
2915 226 88 45
2604 208 84 41
2714 211 86 42
2738 210 82 43
2569 215 86 41
2892 220 88 45
2839 215 89 44
3021 229 101 43
;
DATA Z3;
INPUT DOWN_A DOWN_P DOWN_L DOWN_B;
NN = _N_;
LOC = 'MAS0  ';
VARIETY = 'ARTHUR';
GRP=2;
CARDS;
2550 205 85 41
2747 212 89 42
2708 210 85 42
3172 222 94 46
3163 224 90 46
3187 229 93 46
2779 215 87 42
2978 219 89 45
3145 225 92 47
2946 221 90 45
2821 205 82 46
2958 213 85 47
2878 213 100 86
3253 231 92 47
2834 210 84 44
3130 221 89 47
2940 233 86 44
3101 220 89 46
2994 217 90 44
2929 221 90 44
2853 211 85 73
2802 208 85 44
2770 212 84 43
2969 217 89 45
2763 211 84 45
3067 219 86 47
2951 215 85 46
2995 225 93 42
2847 209 84 44
2767 211 127 83
2581 206 83 42
3188 221 90 46
2779 209 84 45
2840 208 82 46
2843 219 84 44
2916 217 91 44
;
DATA Z4;
INPUT RIGHT_A RIGHT_P RIGHT_L RIGHT_B;
NN = _N_;
LOC = 'MAS0  ';
VARIETY = 'ARTHUR';
GRP=2;
CARDS;
2588 215 86 42
2918 217 91 44
2686 209 85 42
3016 223 92 45
3049 223 91 46
2782 221 99 39
2650 213 87 40
2926 215 88 44
3087 229 92 45
2513 212 88 38
2714 206 82 44
2652 203 84 43
2743 210 85 43
2820 223 94 42
2712 213 86 44
2983 220 89 44
2970 230 85 47
2940 221 91 43
2839 217 90 43
2594 218 82 40
2668 210 87 41
2513 205 85 41
2591 210 85 40
2707 221 85 42
2539 207 84 41
2775 219 87 42
2739 215 84 46
3080 228 94 44
2639 210 90 41
2428 209 86 38
2343 198 83 38
3007 223 89 59
2462 205 86 40
2604 204 85 41
2865 215 85 47
2715 214 90 42
;
DATA LOC1ARK; MERGE Z1 Z2; BY NN;
DATA LOC1ART; MERGE Z3 Z4; BY NN;
DATA Z13;
INPUT DOWN_A DOWN_P DOWN_L DOWN_B;
NN = _N_;
LOC = 'VLAD12';
VARIETY = 'ARKAN ';
GRP=3;
CARDS;
2753 217 92 40
3224 234 89 45
3419 234 96 47
3010 224 92 47
2999 228 96 42
3001 223 95 42
3032 228 95 43
3193 225 93 46
2601 213 94 39
2942 232 93 41
3187 237 99 42
2947 226 95 41
2796 218 91 40
3132 229 95 45
2811 223 94 39
3397 236 96 45
2952 226 95 75
3002 232 96 43
3263 229 93 46
2693 216 90 39
3199 229 93 44
2999 231 98 42
3188 234 98 43
2705 214 90 39
3078 227 88 45
2636 216 92 38
2908 225 91 43
2629 212 84 41
3363 238 99 45
2683 215 95 40
3772 246 103 47
2896 221 90 42
2909 218 89 42
2895 226 97 40
3225 235 98 44
2981 216 86 44
2887 222 84 43
2970 224 90 44
2760 218 92 39
2756 218 87 40
3497 235 98 49
3668 246 97 48
2958 225 95 42
2708 212 88 41
3220 231 97 44
2912 225 96 40
3209 228 88 46
2673 213 87 41
3020 226 92 44
2942 215 85 45
;
DATA Z14;
INPUT RIGHT_A RIGHT_P RIGHT_L RIGHT_B;
NN = _N_;
LOC = 'VLAD12';
VARIETY = 'ARKAN ';
GRP=3;
CARDS;
2994 221 93 44
3225 230 95 46
3365 235 95 46
3210 224 92 47
3182 232 96 46
3033 228 95 44
3163 232 95 46
3071 228 92 44
2735 216 89 41
2854 224 93 39
3542 242 99 47
3049 226 95 44
2821 220 92 43
3055 231 96 43
2818 223 93 40
3220 238 95 44
2976 225 89 43
3392 235 97 49
3264 234 94 45
2766 213 90 41
3125 232 95 44
3070 234 99 43
3196 232 96 45
2898 217 90 43
3221 227 90 48
2882 221 92 41
3103 227 91 45
2798 212 87 43
3365 238 99 45
2810 213 87 43
3616 254 103 45
3073 222 91 46
3103 222 91 45
3098 231 104 43
3300 234 98 47
3018 218 85 47
3204 223 90 48
3130 223 90 47
2866 221 93 42
2824 218 92 41
3590 238 98 50
3682 250 101 49
3312 232 96 47
2759 215 89 43
3151 234 97 43
3003 229 96 42
3036 228 91 43
2701 210 88 42
2995 223 91 43
2989 225 92 45
;
DATA Z15;
INPUT DOWN_A DOWN_P DOWN_L DOWN_B;
NN = _N_;
LOC = 'VLAD12';
VARIETY = 'ARTHUR';
GRP=4;
CARDS;
2915 220 100 43
3209 220 88 48
2827 213 88 43
3178 228 95 45
3269 229 96 46
3174 220 89 48
2968 216 88 45
3160 223 92 45
3155 223 88 47
3473 236 96 48
3077 227 96 44
2970 213 94 46
3008 217 88 45
3302 224 91 47
2988 215 86 46
2762 211 85 43
3211 222 93 45
2978 223 92 44
3222 225 88 48
3081 219 86 47
2546 214 90 37
2799 211 87 43
2729 208 82 43
2890 212 88 43
3405 230 95 48
3092 220 90 47
3302 226 92 49
3117 222 90 47
3588 234 92 52
3024 227 93 43
2908 218 89 44
3043 216 86 46
2928 220 89 43
3228 224 92 48
3113 215 87 47
3275 228 94 47
3146 220 88 49
2946 212 84 48
3340 230 96 46
3049 216 85 48
3557 239 98 49
2907 214 84 46
2963 217 89 44
2982 212 87 45
2600 207 87 40
3113 215 88 49
2692 213 90 41
3024 219 88 47
3062 231 97 43
3558 230 89 53
;
DATA Z16;
INPUT RIGHT_A RIGHT_P RIGHT_L RIGHT_B;
NN = _N_;
LOC = 'VLAD12';
VARIETY = 'ARTHUR';
GRP=4;
CARDS;
2520 218 93 37
2857 213 87 44
2633 212 89 41
3036 225 92 47
2940 223 92 45
2796 217 89 44
2770 212 88 44
2949 223 91 42
3229 221 89 51
3409 235 97 47
2996 230 90 48
2752 212 88 42
2826 217 90 44
3055 225 93 45
2873 213 86 45
2693 212 88 43
2929 224 94 43
2916 224 92 43
3100 223 90 45
2948 218 90 45
2661 216 90 39
2570 210 88 40
2570 206 86 42
2696 211 88 41
3310 231 96 46
2796 216 91 42
2973 224 94 43
2970 225 100 44
2923 223 91 44
2864 222 93 42
2501 214 91 38
2797 213 87 43
2767 218 90 42
2978 225 95 43
2850 222 94 41
2914 213 88 44
2773 217 90 42
2613 206 84 42
3129 229 95 46
2834 215 88 45
2724 230 86 43
3147 238 101 43
2976 218 90 45
2916 211 87 47
2479 209 88 39
2856 215 87 43
2607 217 91 38
2915 214 87 46
2815 230 98 41
3164 227 98 46
;
DATA LOC4ARK; MERGE Z13 Z14; BY NN;
DATA LOC4ART; MERGE Z15 Z16; BY NN;

DATA FINAL; SET LOC1ARK LOC1ART LOC4ARK LOC4ART;
DOWN_A=SQRT(DOWN_A); RIGHT_A=SQRT(RIGHT_A);
KEEP LOC VARIETY GRP DOWN_A--DOWN_B RIGHT_A--RIGHT_B;
run;

PROC DISCRIM DATA=FINAL CAN NCAN=2 OUT=CANSCRS;			 
 CLASS GRP;
 VAR DOWN_A DOWN_P RIGHT_A RIGHT_L RIGHT_B;
 prior proportional;
 RUN;

Proc GPLOT Data=CANSCRS;
 Plot Can1*Can2=GRP;
 Symbol1 V=Dot H=0.7 I=None C=red;
 Symbol2 V=Star H=0.7 I=None C=Blue;
Run;

*****************************************************************
Now we use CAN1 and CAN2 for linear and quadratic discrimination
*****************************************************************;

Proc Means Data=CANSCRS NoPrint;
 Var CAN1 CAN2;
 Output Out=final1 Min=Min1 Min2 Max=Max1 Max2;
Run;

Data PlotF;
 If _N_=1 Then Set final1;
 Inc1=(Max1-Min1)/50;
 Inc2=(Max2-Min2)/50;


 Do CAN1 = (Min1-Inc1) To (Max1+Inc1) By Inc1;
   Do CAN2 = (Min2-Inc2) To (Max2+Inc2) By Inc2;
     Output;
     Keep CAN1 CAN2;
   End;
 End;
 Stop;
Run;

Title 'Linear Discrimination using CANONICAL SCORES';

Proc DISCRIM Data=CANSCRS
             Testdata=PlotF TestOut=PlotP TestOutD=PlotD;
   Class GRP;
   Var CAN1 CAN2;
   prior proportional;
Run;

Proc GPlot Data=PlotP;
 Plot CAN1*CAN2=_Into_/HAxis=Axis1 VAxis=Axis2;
 Axis1  Order=(-3.0 To 3.0 By 1.0);
 Axis2  Order=(-3.0 To 3.0 By 1.0);;
 Symbol1 V=circle H=0.7 I=None C=RED;
 Symbol2 V=Star H=0.7 I=None C=BLACK;
 symbol3 V=dot H=0.7 I=None C=BLUE;
 symbol4 V=circle H=0.7 I=None C=green;
Run; quit;

Title 'Quadratic Discrimination using CANONICAL SCORES';
Proc DISCRIM Data=CANSCRS pool=no
             Testdata=PlotF TestOut=PlotP TestOutD=PlotD;
   Class GRP;
   Var CAN1 CAN2;
      prior proportional;
Run;

Proc GPlot Data=PlotP;
 Plot CAN1*CAN2=_Into_/HAxis=Axis1 VAxis=Axis2;
 Axis1  Order=(-3.0 To 3.0 By 1.0);
 Axis2  Order=(-3.0 To 3.0 By 1.0);;
 Symbol1 V=circle H=0.7 I=None C=RED;
 Symbol2 V=Star H=0.7 I=None C=BLACK;
 symbol3 V=dot H=0.7 I=None C=BLUE;
 symbol4 V=circle H=0.7 I=None C=green;
Run; quit;


ODS Listing;
ODS RTF Close;